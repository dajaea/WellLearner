---
title: "midcourse"
author: "Daniel Eaton"
date: "12/28/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(shiny)
library(tidyverse)
library(shinydashboard)
library(readxl)
library(dplyr)
library(ggplot2)
library(plotly)
#library(treemapify)
#library(extrafont)
#loadfonts(device="win")

#require(scales)
```

```{r}
health_data <- read_csv("../data/Indicators_of_Anxiety_or_Depression_Based_on_Reported_Frequency_of_Symptoms_During_Last_7_Days.csv")
```

```{r}
View(health_data)
```

```{r}
distinct(health_data, Subgroup, .keep_all = FALSE)
```

```{r}
summary(health_data)
```
 
```{r}
health_edu <- read_csv("../data/health_edu.csv")
```

```{r}
#health_edu <- health_edu[-c('Low CI')]
```

```{r}
health_edu <- health_edu %>%
drop_na() %>%
filter(Group = `By Education`) %>%
mutate(Value = as.numeric(as.character(Value))) %>%
mutate(`Time Period` = as.numeric(as.character(`Time Period`))) %>%
#select(State, pre_diploma, diploma_only, bachelors_higher) %>%
#group_by(State) %>%
#summarize(pre_diploma = mean(pre_diploma, na.rm=TRUE), diploma_only = mean(diploma_only, na.rm=TRUE), bachelors_higher = mean(bachelors_higher, na.rm=TRUE))
```

```{r}
health_means <- health_data %>%
  group_by(State, Indicator) %>%
  summarize(Val = mean(Value), Low_CI = mean("Low CI"), High_CI = mean("High CI"), CI = mean("Confidence Interval"), Quartile_Range = mean("Quartile Range"))
```

```{r}
health_means <- health_data %>%
  rename(
    Low_CI = "Low CI",
    High_CI ="High CI"
    ) %>%
  mutate( Low_CI= as.numeric(as.character(Low_CI))) %>%
  mutate( High_CI= as.numeric(as.character(High_CI))) %>%
  group_by(State, Indicator) %>%
  summarize(Val = mean(Value,na.rm=TRUE),
            Low_CI = mean(Low_CI,na.rm=TRUE),
            High_CI = mean(High_CI,na.rm=TRUE))
```

```{r}
View(health_means)
```

```{r fig.height=5, fig.width=18}
ggplot(health_means, aes(State, val)) +
geom_point() +
geom_point(aes(colour = factor(Indicator))) +
aes(x = reorder (State, val), y = val) +
theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust = 1))
```
```{r}
edu_data <- read_csv("../data/Education.csv")
```

```{r}
View(edu_data)
```

```{r}
edu_rename <- edu_data %>%
  rename(pre_diploma = "Percent of adults with less than a high school diploma, 2000", diploma_only = "Percent of adults with a high school diploma only, 2000", bachelors_higher = "Percent of adults with a bachelor's degree or higher, 2000")
```

```{r}
edu_attain <- edu_rename %>%
mutate(pre_diploma = as.numeric(as.character(pre_diploma))) %>%
mutate(diploma_only = as.numeric(as.character(diploma_only))) %>%
mutate(bachelors_higher = as.numeric(as.character(bachelors_higher))) %>%
select(State, pre_diploma, diploma_only, bachelors_higher) %>%
group_by(State) %>%
summarize(pre_diploma = mean(pre_diploma, na.rm=TRUE), diploma_only = mean(diploma_only, na.rm=TRUE), bachelors_higher = mean(bachelors_higher, na.rm=TRUE))
```

```{r}
View(edu_attain)
```








```{r fig.width=10}
edu_data <- read_xls("../data/tabn223.23.xls")
```

```{r}
View(edu_data)
```

```{r}
summary(edu_data)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
